# =============================================================================
# PROJECT CHRONO - http://projectchrono.org
#
# Copyright (c) 2025 projectchrono.org
# All rights reserved.
#
# Use of this source code is governed by a BSD-style license that can be found
# in the LICENSE file at the top level of the distribution and at
# http://projectchrono.org/license-chrono.txt.
# =============================================================================
#
# Schema for a Chrono::FSI-SPH YAML fluid simulation specification file.
# The `chrono-version` must match the Chrono major and minor version numbers.
#
# =============================================================================

required: [chrono-version, type, model, solver]

chrono-version:
  type: string
  description: Chrono version compatible with this YAML specification (M.m or M.m.p)

# -----------------------------------------------------------------------------
# Definitions of common Chrono types

vector3d: &VECTOR3D   # Specification of a ChVector3d
    type: array
    items:
        type: number
    minItems: 3
    maxItems: 3

# -----------------------------------------------------------------------------
# Definition of a Chrono::FSI-SPH simulation

type:
  description: Type of Chrono simulation (must be SPH)
  type: string
  value: SPH

model:
  description: |
      Model specification YAML file.
      The path to the model file must be provided relative to the location of this simulation specification file.
      The model file must follow the fsisph_model.schema.
  type: string

solver:
  description: |
      Solver specification YAML file
      The path to the solver file must be provided relative to the location of this simulation specification file.
      The solver file must follow the fsisph_solver.schema.
  type: string

simulation:
  description: Simulation settings
  type: object
  properties:    
    end_time:
      type: number
      description: |
        Total simulation duration in seconds.
        The simulation will run from t=0 to t=end_time. A negative value indicates na infinite end time.
      minimum: 0
      default: -1
    gravity:
      type: array
      <<: *VECTOR3D
      description: Gravitational acceleration vector [x, y, z]
      default: [0, 0, -9.8]

output:
  description: Output settings
  type: object
  properties:
     type:
        type: string
        description: Output DB type
        enum: [NONE, ASCII, HDF5]
        default: NONE
     fps:
        type: number
        description: Output frequency
        minimum: 0

visualization:
  description: SPH-specific run-time visualization settings
  type: object
  properties:
    sph_markers:
      type: boolean
      description: Render SPH particles
      default: true
    bndry_bce_markers:
      type: boolean
      description: Render boundary BCE markers
      default: true
    rigid_bce_markers:
      type: boolean
      description: Render BCE markers on rigid solids
      default: true
    flex_bce_markers:
      type: boolean
      description: Render BCE markers on flexible solids
      default: true
    # TODO

